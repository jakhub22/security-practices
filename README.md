# ReactJs NextJs best security practices

Ихэнх вэбсайтын халдлагыг ерөнхийд нь хоёр төрөлд ангилж болно: клиент талын халдлага, сервер талын халдлага.

### Clientside attack

Ихэвчлэн маягт эсвэл URL параметрээр дамжуулан хэрэглэгчийн оруулсан мэдээллээр вэбсайт руу хортой код оруулдаг. Эдгээр халдлагад хэрэглэгчийн мэдээллийг хулгайлах, хэрэглэгчийн өмнөөс үйлдэл хийх зорилгоор вэбсайт руу хортой код оруулах, эсвэл хэрэглэгчийг хууран мэхлэхтэй холбоотой сайт хоорондын хүсэлтийг хуурамчаар үйлдэх (CSRF) халдлага багтана.

### Serverside attack

Cервер талын халдлага нь вэбсайтын сервер талын кодын эмзэг байдлыг онилсон халдлагууд хамардаг. Эдгээр халдлагууд нь нууц өгөгдөлд хандахын тулд вэбсайт руу хортой SQL код оруулах, серверийн хяналтыг авахын тулд сервер дээр хортой кодыг гүйцэтгэх (RCE) гэх мэт SQL injection халдлагуудыг багтааж болно.

## Түгээмэл халдлагууд

### 1. Cross-site scripting (XSS) 

![Cross-site scripting](https://portswigger.net/web-security/images/cross-site-scripting.svg)

Хортой скрипт кодыг веб сайт руу оруулдаг. Энэхүү хортой код нь таны cookie, session, token болон бусад нууцлагдмал мэдээллүүд руу таны хөтөчөөр дамжин хандах, хулгайлах үйлдлүүдийг хийдэг.

### 2. Cross-site request forgery (CSRF)

![Cross-site request forgery](https://portswigger.net/web-security/images/cross-site%20request%20forgery.svg)

CSRF халдлага нь халдагч этгээд хэрэглэгчийг хууран өөрийн бэлдсэн хортой скрипт бүхий веб руу хандуулж хэрэглэгчийн browser дээрх зэргэлдээ вебээс өгөгдөл хулгайлах, мэйл хаяг солих, нууц үг өөрчлөх гэх мэт үйлдэл хийлгэж болдог халдлага юм. CSRF довтолгоонд халдагч хохирогч хэрэглэгчийг санамсаргүйгээр үйлдэл хийхэд хүргэдэг. Жишээлбэл, энэ нь тэдний дансны мэйл хаягийг өөрчлөх, нууц үгээ солих, мөнгө шилжүүлэх зэрэг байж болно. Үйлдлийн шинж чанараас хамааран халдагчид хэрэглэгчийн бүртгэлийг бүрэн хянах боломжтой. Хэрэв халдлагад өртсөн хэрэглэгч программ дотор давуу эрхтэй бол халдагчид программын бүх өгөгдөл болон ажиллагааг бүрэн хянах боломжтой.

### 3. SQL injection

![SQL injection](https://portswigger.net/web-security/images/sql-injection.svg)

SQL query-нд тарилга хийх буюу өөрийнхөө хүссэн тэмдэгтүүдийг query дотор оруулаад, дараа нь өөрийнхөө хүссэн үр дүнг гаргаж авах аргыг хэлнэ. Хөгжүүлэгч нь хэрэглэгчээс ирсэн өгөгдөл дээр бүрэн шалгалт хийхгүй шууд query-д ашиглах үед гардаг. Голдуу өгөгдлийн сангаас мэдээлэл хулгайлах, нэвтрэлтийг давж гарах зэрэг үйлдэл хийдэг.

### 4. Clickjacking 

![Clickjacking](https://portswigger.net/web-security/images/clickjacking-infographic.svg)

Clickjacking нь интерфэйс дээр суурилсан халдлага бөгөөд хэрэглэгч ямар нэгэн даралт хийх үед далд вэб сайт дээрх үйлдэл хийх боломжтой болгодог.

### 5. Cross-origin resource sharing (CORS)

![Cross-origin resource sharing](https://portswigger.net/web-security/images/attack-on-cors.svg)

Энэ нь веб сайтд хандалт хийх боломжтой домайны тохиргоо бөгөөд буруу тохиргоо хийснээс болж мэдээллээ алдах эрсдэлтэй.
Ингэснээр таны вебийн resource-руу дурын домайнаас хандалт хийх боломжтой болгож байгаа бөгөөд энэ сул талыг ашиглан CSRF халдлага хийн нууц мэдээлэл хулгайлах боломжтой болдог.

## Халдлагаас сэргийлэх нь

### 1. Token ашиглах

Токенуудыг вэб программуудад хэрэглэгчдийг баталгаажуулах, зөвшөөрөл олгох, мөн Cross-Site Request Forgery (CSRF) зэрэг аюулгүй байдлын эмзэг байдлаас хамгаалахад ашигладаг.

![token](https://i.stack.imgur.com/BPJjA.png)

- Access token : Хандалтын токен нь хэрэглэгчийн нэрийн өмнөөс хамгаалагдсан нөөцөд хандахад хэрэглэгддэг итгэмжлэл юм. Энэ нь ихэвчлэн баталгаажуулалтын серверээс гардаг бөгөөд хэрэглэгчийн таних тэмдэг, зөвшөөрлийг баталгаажуулахын тулд API хүсэлтэд багтдаг.

- Refresh token : Сэргээх токен нь өмнөх хугацаа нь дууссаны дараа шинэ хандалтын токен авахад хэрэглэгддэг итгэмжлэл юм. Энэ нь ихэвчлэн нэвтрэлт таних серверээс хандалтын тэмдэгтэй хамт гаргадаг бөгөөд хэрэглэгчээс итгэмжлэлээ дахин оруулах шаардлагагүйгээр шинэ хандалтын токен авахад ашиглаж болно.

- CSRF token : CSRF токен нь сайт хоорондын хүсэлтийг хуурамчаар үйлдэх халдлагаас урьдчилан сэргийлэх хамгаалалтын функц юм. Энэ нь серверээс үүсгэгдсэн өвөрмөц утга бөгөөд хүсэлт нь хүлээгдэж буй үйлчлүүлэгчээс ирсэн эсэхийг баталгаажуулахын тулд вэб маягт эсвэл API хүсэлтэд багтдаг.

Вэб программд ашиглаж болох бусад төрлийн токенууд нь JSON Web Tokens (JWT), OAuth токенууд болон сессийн токенууд юм. Токен бүр нь тодорхой зорилготой бөгөөд янз бүрийн аюулгүй байдлын эмзэг байдлаас хамгаалахад ашиглагддаг.

### 2. Security header

```js
headers: {
    'Content-Type': 'application/json',
    'X-Content-Type-Options': 'nosniff',
    'X-Frame-Options': 'DENY',
    'X-XSS-Protection': '1; mode=block',
    'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',
    'Referrer-Policy': 'no-referrer'
    'Access-Control-Allow-Origin' : 'https://google.com/'
  }
  ```
- Content-Type : хүсэлтийн хариултын агуулгын төрлийг зааж өгнө
- X-Content-Type-Options : Хөтөчийг хариултын агуулгын төрлийг "таах" оролдлого хийхээс сэргийлж, MIME зэрэг зарим халдлагаас сэргийлж чадна.
- X-Frame-Options : Хуудсыг iframe-д ачаалахаас сэргийлж, энэ нь clickjacking халдлагаас сэргийлж чадна.
- X-XSS-Protection : Хөтөчийн сайт хоорондын скрипт (XSS) хамгаалах механизмыг идэвхжүүлдэг.
- Strict-Transport-Security : Хөтөч нь HTTP-ээр биш зөвхөн HTTPS-ээр сервертэй холбогдох ёстойг зааж өгнө.
- Referrer-Policy : одоогийн вэб сайтаас өөр  сайтруу шилжихэд хөтчид хэр их мэдээлэл оруулахыг хянадаг.
- Access-Control-Allow-Origin : зэргэлдээ сайтаас хандах тохиргоо

### 3. validations

```js
const handleSubmit = (event) => {
    event.preventDefault();
    if (username && password) {
      onSubmit(username, password);
    }
  };
  
  const handleUsernameChange = (value) => {
     const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
     if(regex.test(value)) setEmail(value)
     else return alert("Мэйл хаяг зөв оруулна уу")
  }
  
   return (
    <form onSubmit={handleSubmit}>
      <div>
        <label htmlFor="email">Username:</label>
        <input
          type="email"
          id="email"
          value={email}
          onChange={handleUsernameChange}
        />
      </div>
      <div>
        <label htmlFor="password">Password:</label>
        <input
          type="password"
          id="password"
          value={password}
          onChange={handlePasswordChange}
        />
      </div>
      <button type="submit">Submit</button>
    </form>
  );
};
```
Мөн label element-д for-ийн оронд htmlFor ашигласанаараа Cross-Site Scripting (XSS) attack-аас сэргийлэх юм.



